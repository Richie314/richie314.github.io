<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Calculate ùúã in the browser | Riccardo Ciucci </title> <meta name="author" content="Riccardo Ciucci"> <meta name="description" content="Play with different methods of approximation of ùúã "> <meta name="keywords" content="Riccardo, Ciucci"> <meta property="og:site_name" content="Riccardo Ciucci"> <meta property="og:type" content="website"> <meta property="og:title" content="Riccardo Ciucci | Calculate ùúã in the browser"> <meta property="og:url" content="https://ciucci.dev/projects/pi/"> <meta property="og:description" content="Play with different methods of approximation of ùúã "> <meta property="og:locale" content="en"> <meta name="twitter:card" content="summary"> <meta name="twitter:title" content="Calculate ùúã in the browser"> <meta name="twitter:description" content="Play with different methods of approximation of ùúã "> <script type="application/ld+json">
    {
        "author":
        {
            "@type": "Person",
            "name": "Riccardo Ciucci"
        },
        "url": "https://ciucci.dev/projects/pi/",
        "@type": "WebSite",
        "description": "Play with different methods of approximation of ùúã
",
        "headline": "Calculate ùúã in the browser",
        
        "name": "Riccardo Ciucci",
        "@context": "https://schema.org"
    }
  </script> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?b05f9a0b7405d7c8c89c7465593dea81"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="/assets/css/academicons.min.css?dadeb9c5d1fd12bc8d37475657446863"> <link rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%A7%91%F0%9F%8F%BB%E2%80%8D%F0%9F%92%BB&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://ciucci.dev/projects/pi/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Riccardo</span> Ciucci </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Repos </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">Projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Calculate ùúã in the browser</h1> <p class="post-description">Play with different methods of approximation of ùúã </p> </header> <article> <script defer src="https://cdnjs.cloudflare.com/ajax/libs/decimal.js/9.0.0/decimal.min.js"></script> <script defer src="/assets/js/projects/async-tools.js"></script> <script defer src="/assets/js/projects/pi.js"></script> <p>First, for this demo, we‚Äôre going to need two helper functions to ease calculations and better display the results. This is beacuse most of the code we‚Äôre going to run will be asynchornous.</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">async</span> <span class="kd">function</span> <span class="nf">RunParallel</span><span class="p">(</span><span class="nx">arrayofFunctions</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="nx">arrayofFunctions</span><span class="p">)</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">arrayOfPromises</span> <span class="o">=</span> <span class="nx">arrayofFunctions</span><span class="p">.</span><span class="nf">filter</span><span class="p">(</span><span class="nx">f</span> <span class="o">=&gt;</span> <span class="k">typeof</span> <span class="nx">f</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">function</span><span class="dl">'</span><span class="p">).</span><span class="nf">map</span><span class="p">(</span>
        <span class="p">(</span><span class="nx">f</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">all</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="nc">Promise</span><span class="p">((</span><span class="nx">res</span><span class="p">,</span> <span class="nx">rej</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="nf">res</span><span class="p">(</span><span class="nf">f</span><span class="p">());</span>
            <span class="p">}</span> <span class="k">catch </span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
                <span class="nf">rej</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">})</span>
    <span class="p">);</span>
    <span class="k">return</span> <span class="k">await</span> <span class="nb">Promise</span><span class="p">.</span><span class="nf">all</span><span class="p">(</span><span class="nx">arrayOfPromises</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nf">delay</span><span class="p">(</span><span class="nx">time</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="nx">time</span> <span class="o">||</span> <span class="nf">isNaN</span><span class="p">(</span><span class="nx">time</span><span class="p">))</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">await</span> <span class="k">new</span> <span class="nc">Promise</span><span class="p">(</span><span class="nx">resolve</span> <span class="o">=&gt;</span> <span class="nf">setTimeout</span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">time</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div></div> <p>We‚Äôll also use the <a href="https://mikemcl.github.io/decimal.js/" rel="external nofollow noopener" target="_blank">DecimalJS</a> library and these other functions for basic operations.</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nf">factorial</span><span class="p">(</span><span class="nx">num</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">n</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="k">if </span><span class="p">(</span><span class="nx">num</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">return</span> <span class="nx">n</span><span class="p">;</span>
  <span class="k">for </span><span class="p">(</span><span class="kd">var</span> <span class="nx">k</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="nx">k</span> <span class="o">&lt;=</span> <span class="nx">num</span><span class="p">;</span> <span class="nx">n</span> <span class="o">=</span> <span class="nx">n</span><span class="p">.</span><span class="nf">times</span><span class="p">(</span><span class="nx">k</span><span class="o">++</span><span class="p">))</span> <span class="p">{}</span>
  <span class="k">return</span> <span class="nx">n</span><span class="p">;</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nf">gcd</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nf">minus</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span>
  <span class="k">while </span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nf">comparedTo</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nf">isPositive</span><span class="p">())</span> <span class="p">{</span>
      <span class="nx">a</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nf">dividedBy</span><span class="p">(</span><span class="nx">c</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">b</span> <span class="o">=</span> <span class="nx">b</span><span class="p">.</span><span class="nf">dividedBy</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nf">negated</span><span class="p">());</span>
    <span class="p">}</span>
    <span class="nx">c</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nf">minus</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">a</span><span class="p">;</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nf">CoPrime</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nf">gcd</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">).</span><span class="nf">equals</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div> <p>Already in ancient times there was a need to calculate the circumferences and areas of circles. However, the procedure is not so easy, since ùúã is transcendental and irrational. For this reason, today as in the past, we must resort to approximations, always trying to improve our precision in doing so.</p> <p>The first mathematician to find a procedure to approach ùúã was the Syracusan (of Greek-Carthaginian origin) Archimedes. After him, humanity had to wait until the end of the Middle Ages to see further progress in this research: James Gregory and Gottfried Leibniz developed the procedure that was used until the last century. At the same time, Isaac Newton also developed a similar procedure. However, it was Srinivasa Ramanujan who found the most efficient (in terms of computability) formula to approximate ùúã, a formula that is still used today, with slight modifications.</p> <p>There are also methodologies that have been known for years but never used due to their low speed or precision: the first is a simulation of elastic collisions between two particular bodies, and therefore requires many calculations, although it does not make errors; the second uses random numbers, which are not really obtainable in reality.</p> <h2 id="archimedes-method">Archimede‚Äôs method</h2> <p>The first to try to approximate this value was Archimedes in Syracuse, in 250 BC. He noticed that, by inscribing a regular polygon with more and more sides inside a circle of radius 0.5, its perimeter got closer and closer to ùúã, in this case the value of the circumference. Some even say that Archimedes was killed by a Roman soldier because he refused to stop working on his ‚Äúcircles‚Äù.</p> <p><img src="/assets/img/archimedes_death.jpg" title="Archimede's death" class="m-x-auto d-block rounded-1" style="width: 100%; max-width: 300px;"></p> \[\pi = N sin{180¬∞ \over N}\] <div class="row"> <div class="col col-4"> <div class="row"> <div class="col mb-3"> <div class="input-group"> <span class="input-group-text">N = </span> <input type="number" min="3" max="99999" step="1" value="10" id="archimedes-input" size="5" class="form-control"> </div> </div> </div> <div class="row"> <div class="col"> <span class="italic">ùúã = </span> <output id="archimedes-receive"></output> </div> </div> </div> <div class="col col-8"> <canvas id="archimedes-canvas" width="1000" height="1000" class="m-x-auto" style="max-height: 250px;"></canvas> </div> </div> <p>Archimedes, however, did not have the ‚Äúsine‚Äù and therefore resorted to a simplified version of this formula: starting from <em>N</em> = 6, he doubled the number of sides over and over again, until he reached <em>N</em> = 96.</p> <p>To do this, it is necessary to be able to calculate the side of a rectangular polygon of <em>2N</em> sides, simply by knowing the measure of the one with <em>N</em> sides.</p> <p><img src="/assets/img/archimede-method.svg" title="Archimede's method" style="margin-inline: auto; width: 100%; max-width: 500px;"></p> <p>Simply with the pythagorean theorem we obtain <em>h</em>, and from it <em>L‚Äô</em></p> \[h = r - \sqrt{r^2 - {L^2 \over 4}}\] \[{L'}^2 = 2rh \rightarrow {L'}^2 = 2r^2 - 2r\sqrt{r^2 - {L^2 \over 4}}\] \[L' = \sqrt{2r^2 - 2r\sqrt{r^2 - {L^2 \over 4}}}\] \[\pi \approx N \times L' = N\sqrt{2r^2 - 2r\sqrt{r^2 - {L^2 \over 4}}}\] <p>Starting from the hexagon it is simple, since <em>L</em> = <em>r</em></p> <div class="row"> <div class="col col-4"> <div class="row"> <div class="col mb-3"> <div class="input-group"> <span class="input-group-text">N = </span> <select id="archimedes-input-2" class="form-control"> <option value="6">6</option> <option value="12">12</option> <option value="24">24</option> <option value="48">48</option> <option value="96">96</option> <option value="192">192</option> <option value="384">384</option> <option value="768">768</option> <option value="1536">1536</option> <option value="3072">3072</option> </select> </div> </div> </div> <div class="row"> <div class="col"> <span class="italic">ùúã = </span> <output id="archimedes-receive-2"></output> </div> </div> </div> <div class="col col-8"> <canvas id="archimedes-canvas-2" width="1000" height="1000" class="d-none m-x-auto" style="max-height: 250px;"></canvas> </div> </div> <p>By using this procedure up to <em>N</em> = 96, repeating it not only by inscribing but also by circumscribing the polygons, the Sicilian managed to arrive at</p> \[{223 \over 71} &lt; \pi &lt; {22 \over 7}\] <p>It is worth noting that the mathematician did not have a modern method for calculating square roots and was thus forced to use only approximate techniques.</p> <h2 id="madhava-gregory-leibnizs-series">Madhava-Gregory-Leibniz‚Äôs series</h2> <p>In 1668, Scottish mathematician and astronomer James Gregory devised an infinite series to approximate the inverse of tangents.</p> \[tan^{-1}{x} = \sum_{K=0}^\infty { {(-1)^K x^{2K+1} } \over {2K+1} } = x - {x^3 \over 3} + {x^5 \over 5} - {x^7 \over 7} + {x^9 \over 9} - {x^{11} \over 11} + ...\] <p>Gottfried Leibniz, a few years later, imposed x = 1 and thus obtained:</p> \[{\pi \over 4} = \sum_{K=0}^\infty { { (-1)^K } \over {2K+1} } = 1 - {1 \over 3} + {1 \over 5} - {1 \over 7} + {1 \over 9} - {1 \over 11} + ...\] <p>To approximate ùúã it will be possible to insert a very large value of <em>N</em> into the following formula:</p> \[\pi \approx 4 \sum_{K=0}^N { { (-1)^K } \over {2K+1} }\] <div class="row"> <div class="col"> <div class="input-group"> <span class="input-group-text">N = </span> <input type="number" min="4" max="1000000" step="1" value="1000" id="leibniz-input" size="10" class="form-control"> </div> </div> <div class="col"> <span class="italic">ùúã = </span> <output id="leibniz-receive">3.14</output> </div> </div> <p>These two series are easily proved by the work of another Indian mathematician of two centuries earlier, Madhava of Sangamagrama, who first derived the way to approximate an angle from its tangent:</p> \[\theta = \sum_{N=0}^\infty { {(-1)^N tan^{2N+1}{\theta} } \over {2N+1} } = tan{\theta} - {tan^3{\theta} \over 3} + {tan^5{\theta} \over 5} - {tan^7{\theta} \over 7} + ...\] <p>By setting \(Œ∏ = ùúã / 4\), we arrive at Leibniz‚Äôs formula.</p> <h3 id="implementation">Implementation</h3> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">async</span> <span class="kd">function</span> <span class="nf">Leibniz</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">p</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">One</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="c1">// Used to not generate n uneeded instances</span>
    <span class="kd">let</span> <span class="nx">even</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="k">for </span><span class="p">(</span><span class="kd">let</span> <span class="nx">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">k</span> <span class="o">&lt;=</span> <span class="nx">n</span><span class="p">;</span> <span class="nx">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">t</span> <span class="o">=</span> <span class="nx">One</span><span class="p">.</span><span class="nf">dividevBy</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="nx">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
        <span class="k">if </span><span class="p">(</span><span class="nx">even</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">p</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nf">plut</span><span class="p">(</span><span class="nx">t</span><span class="p">);</span> <span class="c1">// 2,4,6,...</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">p</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nf">minus</span><span class="p">(</span><span class="nx">t</span><span class="p">);</span><span class="c1">// 1,3,5</span>
        <span class="p">}</span>
        <span class="nx">even</span> <span class="o">=</span> <span class="o">!</span><span class="nx">even</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">p</span><span class="p">.</span><span class="nf">times</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div> <h2 id="ramanujans-formula">Ramanujan‚Äôs formula</h2> <p>Srinivasa Ramanujan, an Indian mathematician, in 1910 arrived at this series which converges in the reciprocal of ùúã:</p> \[{1 \over \pi} = { {2 \sqrt{ 2 }} \over 9801}\sum_{k=0}^\infty { { (4k)! (1103 + 26390k)} \over { (k!)^4 396^{4k}} }\] <p>This series was the basis for the ‚Äúfast algorithms‚Äù for computing ùúã, in particular this formula was taken up and modified in 1988 by the Chudnovsky brothers who wrote:</p> \[{1 \over \pi} = 12\sum_{k=0}^\infty { { (-1)^k (6k)! (13591409 + 545140134k)} \over { (3k)! (k!)^3 (640320)^{3(k+1/2)} } }\] <p>Later simplified to:</p> \[{128096012 \over {3\pi}} = \sum_{k=0}^\infty { { (6k)! (13591409 + 545140134k)} \over { (3k)! (k!)^3 (-2625374112640768000)^k } }\] <p>Each term of the sum is very complex to calculate but the convergence to ùúã is very fast: with just 2 iterations you can correctly obtain 9 decimal places.</p> <div class="row"> <div class="col"> <div class="input-group"> <span class="input-group-text">k = </span> <input type="number" min="2" max="256" step="1" value="4" id="ramanujan-input" size="10" class="form-control"> </div> </div> <div class="col"> <span class="italic">ùúã = </span> <output id="ramanujan-receive">3.140592653839794</output> </div> </div> <h3 id="implementation-1">Implementation</h3> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">async</span> <span class="kd">function</span> <span class="nf">Ramanujan</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">oldP</span> <span class="o">=</span> <span class="nx">Decimal</span><span class="p">.</span><span class="nx">precision</span><span class="p">;</span>
    <span class="nx">Decimal</span><span class="p">.</span><span class="nf">set</span><span class="p">({</span> <span class="na">precision</span><span class="p">:</span> <span class="mi">5</span> <span class="o">*</span> <span class="nx">n</span> <span class="p">});</span> <span class="c1">// We're gonna need a lot of precision</span>

    <span class="c1">// Since the operation is quite resource expensive, </span>
    <span class="c1">// calculations will be splitted in two blocks (that will later be summed).</span>
    <span class="c1">// This will result in a slight performance loss (JS is single-threaded)</span>
    <span class="c1">// but will prevent the browser UI from freezing</span>
    <span class="kd">const</span> <span class="nx">pivot</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nf">floor</span><span class="p">(</span><span class="nx">n</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>
    <span class="kd">let</span> <span class="nx">blocks</span> <span class="o">=</span> <span class="k">await</span> <span class="nc">RunParallel</span><span class="p">([()</span> <span class="o">=&gt;</span> <span class="nc">RamanujanIteration</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">pivot</span><span class="p">),</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nc">RamanujanIteration</span><span class="p">(</span><span class="nx">pivot</span><span class="p">,</span> <span class="nx">n</span><span class="p">)]);</span>
    <span class="kd">const</span> <span class="nx">C</span> <span class="o">=</span> <span class="nc">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="nf">div</span><span class="p">(</span><span class="nc">Decimal</span><span class="p">(</span><span class="mi">426880</span><span class="p">).</span><span class="nf">times</span><span class="p">(</span><span class="nc">Decimal</span><span class="p">(</span><span class="mi">10005</span><span class="p">).</span><span class="nf">sqrt</span><span class="p">()));</span> <span class="c1">// Constant we will divide the results by</span>
    <span class="kd">let</span> <span class="nx">p</span> <span class="o">=</span> <span class="nc">Decimal</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="nf">div</span><span class="p">(</span><span class="nx">C</span><span class="p">.</span><span class="nf">times</span><span class="p">(</span><span class="nx">blocks</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">plus</span><span class="p">(</span><span class="nx">blocks</span><span class="p">[</span><span class="mi">1</span><span class="p">])));</span>
    
    <span class="nx">Decimal</span><span class="p">.</span><span class="nf">set</span><span class="p">({</span> <span class="na">precision</span><span class="p">:</span> <span class="nx">oldP</span> <span class="p">});</span> <span class="c1">// Restore the initial precision</span>
    <span class="k">return</span> <span class="nx">p</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nf">RamanujanIteration</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span> <span class="nx">end</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">p</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Decimal</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="k">for </span><span class="p">(</span><span class="kd">var</span> <span class="nx">k</span> <span class="o">=</span> <span class="nx">start</span><span class="p">;</span> <span class="nx">k</span> <span class="o">&lt;</span> <span class="nx">end</span><span class="p">;</span> <span class="nx">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">Mk</span> <span class="o">=</span> <span class="nc">Decimal</span><span class="p">(</span><span class="nf">factorial</span><span class="p">(</span><span class="mi">6</span> <span class="o">*</span> <span class="nx">k</span><span class="p">)).</span><span class="nf">div</span><span class="p">(</span><span class="nc">Decimal</span><span class="p">(</span><span class="nf">factorial</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="nx">k</span><span class="p">)).</span><span class="nf">times</span><span class="p">(</span><span class="nc">Decimal</span><span class="p">(</span><span class="nf">factorial</span><span class="p">(</span><span class="nx">k</span><span class="p">)).</span><span class="nf">pow</span><span class="p">(</span><span class="mi">3</span><span class="p">)));</span>
        <span class="kd">const</span> <span class="nx">Lk</span> <span class="o">=</span> <span class="nc">Decimal</span><span class="p">(</span><span class="mi">545140134</span><span class="p">).</span><span class="nf">times</span><span class="p">(</span><span class="nx">k</span><span class="p">).</span><span class="nf">plus</span><span class="p">(</span><span class="mi">13591409</span><span class="p">);</span>
        <span class="kd">const</span> <span class="nx">Xk</span> <span class="o">=</span> <span class="nc">Decimal</span><span class="p">(</span><span class="o">-</span><span class="mi">262537412640768000</span><span class="p">).</span><span class="nf">pow</span><span class="p">(</span><span class="nx">k</span><span class="p">);</span>
        <span class="nx">p</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nf">plus</span><span class="p">(</span><span class="nx">Mk</span><span class="p">.</span><span class="nf">times</span><span class="p">(</span><span class="nx">Lk</span><span class="p">).</span><span class="nf">div</span><span class="p">(</span><span class="nx">Xk</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">p</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <h2 id="the-collisions-method">The collisions method</h2> <p>It seems absurd but this simulation of elastic collisions manages to calculate Pi!</p> <p>Both blocks perform elastic collisions with each other and the left block bounces without losing energy when it hits the wall. The masses of the blocks are not random: the small block has a mass of unit while the other has a mass that is a multiple of 100.</p> <p>Almost magically the number of collisions that the small block performs approximates ùúã.</p> <p><a href="https://www.youtube.com/watch?v=jsYwFizhncE" title="Watch on YouTube" rel="external nofollow noopener" target="_blank">Watch the explaination on Youtube</a></p> <p>The exponential complexity of the algorithm makes it terrible for computation times: for this reason it has never really been used to calculate digits of ùúã unknown to us.</p> <p>It is still fun to simulate and watch.</p> <div class="row"> <div class="col"> <div class="row"> <div class="col mb-3"> <label for="collision-input" class="form-label"> Digits </label> <input type="number" id="collision-input" class="form-control" min="2" value="4" max="7" step="1"> </div> </div> <div class="row"> <div class="col mb-3"> <button type="button" id="collision-start" class="btn btn-primary"> Start </button> </div> </div> <div class="row"> <div class="col"> <span> ùúã = </span> <output id="collision-receive">0</output> </div> </div> </div> <div class="col col-9"> <canvas id="collision-canvas" width="600" height="300" style="width: 100%; margin-inline: auto; max-height: 350px;"></canvas> </div> </div> <h2 id="montecarlos-method">Montecarlo‚Äôs method</h2> <p>Taking a quarter of a circumference inscribed in a square, we have that the ratio between the areas is</p> \[{ { {\pi r^2} \over 4 } \over {r^2}} = { {\pi r^2} \over {4 r^2}} = { \pi \over 4}\] <p>By drawing a significant amount of points, the ratio between the number of points inside the quarter of the circle and the total number of points should be approximately the same as that of the areas.</p> \[{N_{Internals} \over N_{Total}} \approx { \pi \over 4}\] <p>Because it uses randomly drawn numbers, this method is also called the Monte Carlo Method.</p> <div class="row"> <div class="col"> <div class="row"> <div class="col mb-3"> <label for="random-function-select" class="form-label"> Random generator </label> <select id="random-function-select" class="form-control"> <option value="default">Browser built in</option> <option value="decimalJS">From Decimal.js library</option> </select> </div> </div> <div class="row"> <div class="col mb-3"> <button type="button" class="btn btn-primary" id="random-input"> Start </button> </div> <div class="col mb-3"> <button type="button" class="btn btn-primary" id="random-reset"> Reset </button> </div> </div> <div class="row"> <div class="col"> <span>ùúã = </span> <output id="random-receive" class="receive">3.14</output> </div> </div> <div class="row"> <div class="col"> <span>Number of points: </span> <span id="random-total" class="receive">0</span> </div> </div> </div> <div class="col col-8"> <canvas id="random-canvas-1" width="1000" height="1000" class="d-block m-x-auto border border-1" style="max-height: 200px;"></canvas> </div> </div> <p>The use of randomly generated numbers unfortunately makes the values found not very reliable, as it is not possible to generate a number in a completely unconditional way. However, these ‚Äúextractions‚Äù can be an indication of how good the algorithm that returns pseudo-random numbers is.</p> </article> </div> </div> <footer class="sticky-bottom mt-5"> <div class="container"> ¬© Copyright 2025 Riccardo Ciucci. <br>Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme and hosted on <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>.<br> Last updated: September 09, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf"></script> <script src="/assets/js/tooltips-setup.js?53023e960fbc64cccb90d32e9363de2b"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script defer id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?70d799092f862ad98c7876aa47712e20"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?230637657ac0b42e92d76e2b4c1b4764"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>